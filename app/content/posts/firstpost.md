title: Building a Static Site with Flask and AWS
date: 2013-09-07
tags: [python, flask, aws, flask-frozen, flask-flatpages]

##Introduction

Clean and Simple.

When I decided it was time build my own webpage, I wanted the code, the UI, the blog, everything, to be clean and simple. 

This post documents that steps it took to build this site, and offers a explanation of how you can do it yourself.

##Building the Backend

The site you are currently looking at is comprised of static pages. All of these pages are generated by a Flask package called Flask-Frozen.

In the spirit of the [DRY Principle](http://en.wikipedia.org/wiki/Don't_repeat_yourself), I'm not going to try and explain things that people have done, but rather, point you toward the documentation I used to create the pages. 

James Harding has an excellent post describing how to get a Flask site up and running use Flask-FlatPages and Flask-Frozen. [Check it out.](http://www.jamesharding.ca/posts/simple-static-markdown-blog-in-flask/)

Now, one thing I want to point out about that tutorial is that, everything is contained in 1 file. 

##Project Organization
    ├── README.md
    ├── requirements.txt
    ├── config.py
    ├── run.py
    └── app
        ├── __init__.py
        ├── views.py
        └── build
            ├── ...
        └── content
            ├── ...
        └── static
            ├── ...
        └── templates
            ├── ...


##Uploading Content

Now that I had the code necessary to start generating my site as static pages, I needed to get it up on the web! 

####AWS
After some minimal research, I realized that you can actually [host static websites on Amazon S3](http://docs.aws.amazon.com/AmazonS3/latest/dev/website-hosting-custom-domain-walkthrough.html). This is amazing because Amazon's AWS Platform is extremely robust, has numerous tools to interface with it (awscli, boto, etc.), and it costs pennies to keep your website up (literally).

Before you start uploading your pages to the web, you need configure some buckets so that they can host your page. 

####aws-cli

Once I had finished configuring my buckets, I needed an easy to way to upload the static pages to the S3 buckets. 

Enter [aws-cli](http://aws.amazon.com/cli/). 

This tool allows you to cp an entire directory straight to AWS. If you directory has subdirectories, it will create the necessary folders, and upload all that content as well. 

To upload your content to your S3 bucket from the command-line: 

1. Install aws-cli: `pip install awscli`
2. To upload ALL your content from your `build` folder, simply type:  
`aws s3 cp YOUR_BUILD_DIR s3://YOUR_BUCKET_NAME --recursive --region YOUR_REGION`
3. (Optional) create an alias in your virtualenv, so you don't have to keep typing this. I added to the alias to `postactivate` file found in `/.virtualenv/YOUR_VIRTUALENV/bin/`

SO. At this point, we have a running Flask application that automatically generates all our static pages. We have a single command-line argument that uploads all the content to S3, AND Amazon's insanely-robust datacenter is making sure our site will be up 99.99% percent of the time.

Clean and Simple.

##TL:DR;

Here is the full technology **stack**: 

Productivity: [virtualenv](https://pypi.python.org/pypi/virtualenv)  [virtualenvwrapper](http://virtualenvwrapper.readthedocs.org/en/latest/) [aws-cli](http://aws.amazon.com/cli/)  

Backend: [Flask](http://flask.pocoo.org/) [Flask-FlatPages](http://pythonhosted.org/Flask-FlatPages/) [Flask-Frozen](http://pythonhosted.org/Frozen-Flask/)

Hosting: [AWS](http://aws.amazon.com/)  

Here are some helpful **tutorials**:  
[Build a Simple, Static, Markdown-Powered Blog in Flask](http://www.jamesharding.ca/posts/simple-static-markdown-blog-in-flask/)  
[Setting up a Website Using a Custom Domain in AWS](http://docs.aws.amazon.com/AmazonS3/latest/dev/website-hosting-custom-domain-walkthrough.html)